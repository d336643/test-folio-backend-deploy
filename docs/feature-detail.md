# 功能詳細解釋

## 備註
- 先不要放加碼儲值的功能
  - 放了的話會太複雜，有一堆機制要設計
  - 如果要做的話應該是每個新的投組都要設定不能一口氣加太多錢之類的
- 刪單 / 改量 / 改價需要設計的機制太多了，先不寫
- 等比例的定義為：當下 Folloer 的現金和 Provider 身上的自由資金比例

## 人物介紹
- User（使用者）
  - 每個人都同時可以是 Provider 和 Follower
  - Provider
    - eToro 中的史蒂夫
    - 提供（provide）投資組合的人
  - Follower
    - eToro 中的戴夫
    - 跟隨（follow）投資組合的人

## 新增投資組合
- 投資組合的概念就像是一個帳戶戶頭
  - 一個用戶可以有好幾個投資組合（就像一個人可以開好幾個證券戶一樣）
  - 一個投資組合裡面有現金和股票兩種資產
- 當一個 User 新增投資組合他就是這個投組的 Provider
- 投資組合有以下的屬性
  - 名字：可以自己隨便亂取
  - 說明：描述投組的字串
  - id：自動生成
  - 歷史報酬率：可以有各種 view ，例如年報酬率、月報酬率、blablabla
  - ...
- 新增一個投資組合的步驟
  1. 命名和說明等等
  2. 在這個投組中儲值一定的金額（這個金額以後不能再加碼，詳見備註）
  3. 一些財務工程相關的設定（目前還不用加）

## Provider 新增交易
- 一個 Provider 新增交易（transaction）的步驟：
  1. 選擇要在自己帳戶下的哪一個投資組合新增交易
  2. 選擇以什麼價格買 / 賣幾張哪一支股票
     - 不能超過該投組剩餘自由資金的上限
     - 登記該價位，由本系統進行下單，但不見得能夠成交（市場上要剛好能夠買到）
  3. 不可逆（不能刪單、改量、改價，詳見備註）
  4. 若當天收盤前該委託尚未被搓合則無視該交易

## Follower 跟隨投資組合
- 點選 Follow 該投資組合後，必須儲值金額進該帳戶
- 當 Follower 跟隨一個投資組合後，其實就是也開了一個虛擬帳戶
  - 但這個虛擬帳戶（投組）對 Follower 來說是唯讀的
  - 只有我們的系統可以操作這個帳戶
  - 對比 Provider 的虛擬帳戶（投組）對 Provider 來說是可以讀寫的
- 可能 15(?) 分鐘後該 follow 會生效
  - 從此之後， Provider 的任何 transaction 會以等比例被複製到本帳戶之中
- 若當天收盤前該委託尚未被搓合則無視該交易

## 系統帳戶設計
- Folio 本身辦一個證券帳戶
  - 真正和券商有關係的只有這一個帳戶
  - 系統自動用這個帳戶的 API 下單
- 每個使用者會被分配到一些虛擬帳戶
  - 虛擬帳戶!!*不是*!!銀行證券帳戶
  - 是由系統生成的虛擬帳戶 (virtualized)
  - 當然會有帳戶 id
  - 虛擬帳戶和投組是一一對應的關係
  - 用戶在開創虛擬帳戶（投資組合）的時候就要儲值本金了
- 在虛擬帳戶的任何買賣行為都會被後端 aggregate 起來
  - 假設甲用戶在自己的投組 A 用 550 的價格登記購買 0.5 張台積電
  - 系統後端會 aggregate 這個 action 會造成的影響
    - 投組 A 有 3 個用戶：乙丙丁
    - 乙：依比例購買 0.3 張台積電
    - 丙：依比例購買 0.2 張台積電
    - 丁：依比例購買 0.7 張台積電
  - 最後系統會下單用 550 的價格買 0.3 + 0.2 + 0.7 + 0.5 = 1.7 張台積電（用真正唯一的實體帳戶）



---
my thought
是不是其實就是一個開源基金平台啊？做一做突然覺得好像是這樣
稍微不一樣的地方是基金是自己可以隨時任意加碼
這樣想起來開源基金平台是不是比較彈性？
不過沒差這個 final project 過後可以再討論，現在先繼續這樣做
